---
title: "R Notebook"
output: html_notebook
---

# Unit 1: Intro to Analytics 

## Getting Started in R

```{r}
# Get help on functions
?sqrt

# Get a list of vars in env
ls()
```


## Vectors and DataFrames

```{r}
# Create a vector using c function
country <- c("Brazil", "China", "India", "Switzerland", "USA")
LifeExpectancy <- c(74, 76, 65, 83, 79)

# To display an element of a vec, use [ ]
country[3]

# To create a sequence, use seq
seq(0,100,2)

# Combine vecs into a df structure
CountryData <- data.frame(country, LifeExpectancy)
CountryData

# Now, add a var to this df. Use a $ to link the data
CountryData$Population <- c(199000,1390000, 1240000,7997,318000)

CountryData

# Now, add 2 new countries: Aus and Grc. 
country <- c("Australia", "Greece")
LifeExpectancy <- c(82,81)
Population <- c(23050,11125)

NewCountryData <- data.frame(country, LifeExpectancy, Population)
NewCountryData

# Now, combine CountryData and NewCountryData
AllCountryData <- rbind(CountryData, NewCountryData)
AllCountryData
```

## Loading Data Files

```{r}
getwd()
WHO <- read.csv("WHO.csv")
str(WHO)

summary(WHO)

# Subsetting data to include only countries in EU
?subset
WHO_Europe <- subset(WHO,Region = "Europe")
WHO_Europe

# Now, remove WHO_Europe from environment
rm(WHO_Europe)
ls()

```

## Data Analysis - Summary Stats and Scatterplots

```{r}
mean(WHO$Under15)
sd(WHO$Under15)
summary(WHO$Under15)  #13.12% of pop is under 15 (min) - which one is it?  Japan!
WHO$Country[which.min(WHO$Under15)]

# Which country has max under 15? Niger with 49.99!
WHO$Country[which.max(WHO$Under15)]

# Create a scatterplot of GNI vs. fertility rate
plot(WHO$GNI, WHO$FertilityRate)

# look at countries with a GNI > 10,000 and Fertility Rate > 2.5
outliers <- subset(WHO, GNI > 10000 & FertilityRate > 2.5)
nrow(outliers)

outliers[c("Country", "GNI", "FertilityRate")]

# What is the mean value of WHO$Over60? 11.16366
mean(WHO$Over60)

# Which country has the smallest % of pop over 60?
WHO$Country[which.min(WHO$Over60)]

# which country has the largest literacy rate?
WHO$Country[which.max(WHO$LiteracyRate)]

```

## Data Analysis - Plots and Summary Tables

IQR = Difference between 1st and 3rd quartiles  
Any point that is > 3rd quartile + IQR or < 1st quartile - IQR is an outlier.

1. EU has highest median life expectancy.  
2. Americas has the smallest IQR.  
3. Eastern Mediterranean has the highest overall range of life expectancy.  



```{r}
# Histograms

hist(WHO$CellularSubscribers)

# Boxplot

boxplot(WHO$LifeExpectancy~WHO$Region)

#  Add labels
boxplot(WHO$LifeExpectancy~WHO$Region, xlab = "", ylab = "Life Expectancy", main = "Life Expectancy of Countries by Region")

# Summary Tables

table(WHO$Region)

# tapply...splits data by 2nd arg, then applies the 3rd to the var given as 1st. Take the mean of those > 60 by region.

tapply(WHO$Over60, WHO$Region, mean)

tapply(WHO$LiteracyRate, WHO$Region, min, na.rm=T)

# Use tapply to find the average child mortality rate of countries in each region.
tapply(WHO$ChildMortality, WHO$Region, mean)

```

## Recitation 1 - Nutrition
In 1990, all states had < 14% obesity. By 2000, half of the country had > 20% of its population obese.  By 2010, all states had > 20% of its population obese.

```{r}
USDA <- read.csv("USDA.csv")
str(USDA)
summary(USDA)

# The max of sodium is very high, which value does it correspond to?
USDA$Description[which.max(USDA$Sodium)]

# Which foods contain > 10,000 mg of sodium?
HighSodium <- subset(USDA, Sodium > 10000)
nrow(HighSodium)
HighSodium$Description

# How much salt does caviar have? 1500
USDA$Sodium[match("CAVIAR", USDA$Description)]

# Compare Caviar to mean and sd across dataset. Mean sodium = 322.1, SD Sodium= 1045.417
# 322 + 1045 = 1367 -> caviar is > 1 SD above the mean
summary(USDA$Sodium)
sd(USDA$Sodium, na.rm = T)

## Creating Plots in R 

# Create a scatterplot w/ Protien on the x-axis and Fat on the y-axis
plot(USDA$Protein, USDA$TotalFat, xlab="Protien", ylab= "Total Fat", main = "Protien vs Fat", col = "blue")

# Create a hist of Vitamin C
hist(USDA$VitaminC, main = "Histogram of Vitamin C Levels")

# Need to zoom in on < 100mg

hist(USDA$VitaminC, main = "Histogram of Vitamin C Levels", xlim = c(0,100))

# Now, break up into 100 increments.  We only see 5 cells and each cell is 20mg?  Original went to 2000mg.  2000mg/100 = 20mg
?hist
hist(USDA$VitaminC, main = "Histogram of Vitamin C Levels", xlim = c(0,100), breaks = 100)

# let's get to 100 breaks
hist(USDA$VitaminC, main = "Histogram of Vitamin C Levels", xlim = c(0,100), breaks = 2000, col = "pink")

# boxplot for sugar
boxplot(USDA$Sugar, main = "Boxplot of Sugar Levels", ylab = "Sugar in grams")

# Adding variables 
# Add a 1 if food is higher than sodium avg and 0 if less than sodium average
USDA$Sodium[1] > mean(USDA$Sodium, na.rm = T)
USDA$Sodium[50] > mean(USDA$Sodium, na.rm = T)
USDA$HighSodium <- as.numeric(USDA$Sodium > mean(USDA$Sodium, na.rm = TRUE))
str(HighSodium)
USDA$HighProtien <- as.numeric(USDA$Protein > mean(USDA$Protein, na.rm = TRUE))
USDA$HighFat <- as.numeric(USDA$TotalFat > mean(USDA$TotalFat, na.rm = TRUE))
USDA$HighCarbs <- as.numeric(USDA$Carbohydrate > mean(USDA$Carbohydrate, na.rm = TRUE))
str(USDA)

# Summary Tables
## Now, figure out how many foods have a higher sodium level than average
table(USDA$HighSodium)

## Now, how many have High Sodium and High Fat? Rows are first input, cols are second
table(USDA$HighSodium, USDA$HighFat)

## Now, what if wanted avg amount of Iron sorted by Hi and Lo protien? NEED TAPPLY? WHY?
## tapply Groups arg 1 by arg 2 and applies arg 3

tapply(USDA$Iron, USDA$HighProtien, mean, na.rm = TRUE)

## What is the max level of Vitamin C in foods with Hi and Lo carbs?
tapply(USDA$VitaminC, USDA$HighCarbs, max, na.rm = TRUE)

## is it true that foods high in carbs have a high vitamin C content? Yes, on average
tapply(USDA$VitaminC, USDA$HighCarbs, summary, na.rm = TRUE)

```


## HW - An Analytical Detective

```{r}

```


This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.